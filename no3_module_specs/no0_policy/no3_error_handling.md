# 錯誤處理與日誌規範

## 錯誤處理

- **核心原則**
    - **使用者體驗:** 任何錯誤都不應導致 App 崩潰
    - **資訊傳達:** 必須向使用者顯示清晰、友善的提示
    - **禁止:** `alert`
    - **偏好:** 使用 App 內的 Modal 或 Toast 元件顯示訊息
- **錯誤類型 - 可預期錯誤**
    - **定義:** 使用者操作或環境導致的非程式錯誤
    - **範例:**
        - 網路連線中斷
        - 登入憑證錯誤
        - 表單驗證未通過
        - 嘗試建立第 4 個帳戶
    - **行為:**
        - **IF** 錯誤發生:
            - **行為:** 
              - 必須在 UI 上顯示具體的友善提示訊息
              - 不應紀錄到遠端日誌伺服器
- **錯誤類型 - 未預期錯誤**
    - **定義:** 程式邏輯缺陷或未處理的系統異常
    - **範例:**
        - `null` 引用
        - 狀態管理不一致
        - API 回應格式非預期
    - **行為:**
        - **IF** 錯誤發生:
            - **行為:** 
              - 必須使用 `try...catch` 或錯誤邊界 Error Boundary 捕捉
              - 必須紀錄到遠端日誌伺服器
              - 必須向使用者顯示通用的錯誤訊息
            - **範例:** 發生未知錯誤，請稍後再試

---

## 日誌規範

- **核心工具**
    - **要求:** 必須導入遠端日誌與崩潰分析服務
    - **範例:** 
      - Sentry
      - Firebase Crashlytics
- **日誌等級**
    - **Debug**
        - **用途:** 開發階段除錯使用
        - **禁止:** 在生產環境 Production build 中啟用
    - **Info**
        - **用途:** 紀錄關鍵的使用者流程或系統事件
        - **範例:** 
          - `使用者登入成功`
          - `批次同步執行完成`
    - **Warning**
        - **用途:** 紀錄潛在問題，但不影響當前操作
        - **範例:** API 回應緩慢
    - **Error**
        - **用途:** 紀錄所有被捕捉到的未預期錯誤
- **日誌內容**
    - **要求:** 必須包含足夠的上下文以供除錯
    - **結構:**
        - 錯誤訊息
        - 錯誤堆疊 Stack Trace
        - 發生錯誤的函式或畫面
        - 使用者 ID
        - **行為:** 需匿名化
    - **隱私規範:**
        - **禁止:** 紀錄任何敏感性個人資料
        - **範例:** 
          - 密碼
          - 完整的姓名或 Email