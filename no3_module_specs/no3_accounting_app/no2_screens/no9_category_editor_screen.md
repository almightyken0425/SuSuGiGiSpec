# 類別編輯器畫面: CategoryEditorScreen

## 畫面目標

- **提供:** 新增或編輯類別的統一介面
- **確保:** 所有自訂類別均映射到標準類別

```text
+--------------------------------+
| Cancel      Title       Done   |
+--------------------------------+
| Name: [ Input Text ]           |
| Map To: [ Standard Cat ] ˅     |
| Icon: [ Icon Preview ] ˅       |
|                                |
+--------------------------------+
```

---

## UI 佈局

- **頂部導航列:**
    - `取消按鈕`
    - `標題`
        - **IF 新增模式:** 新增支出類別或新增收入類別
        - **IF 編輯模式:** 編輯支出類別或編輯收入類別
    - `完成按鈕`
        - **啟用條件:** 所有必填欄位有效
- **核心欄位區:**
    - `類別名稱輸入框`
        - **UI:** 文字輸入框 TextInput
        - **屬性:** 必填
    - `圖示選擇器`
        - **UI:** 顯示當前所選圖示的區域
        - **導航:** IconPickerScreen
        - **屬性:** 必填
    - `標準類別映射選擇器`
        - **UI:** 選擇器
        - **行為:** 點擊彈出 StandardCategory.json 列表
        - **邏輯:** 列表依 `categoryType` 過濾
        - **屬性:** 必填


---

## 核心邏輯

- **模式判斷:**
    - **觸發:** 畫面載入
    - **判斷依據:** 導航參數 `categoryId`
    - **IF 有 categoryId 編輯模式:**
        - **讀取:** 從本機 DB 讀取類別資料填入表單
    - **IF 無 categoryId 新增模式:**
        - **預設:** categoryType 預設為支出
- **儲存邏輯:**
    - **觸發:** 點擊儲存按鈕
    - **IF 新增模式:**
        - **付費牆檢查:**
            - **檢查:**
                - `PremiumLogic.checkPremiumStatus()` 狀態
                - 本機 DB 類別數量
            - **IF 免費版 AND 類別數量已達上限:**
                - **導航:** PaywallScreen
            - **ELSE:**
                - **寫入:** 本機 DB 建立新記錄
                - **欄位:** 必須設定 `updatedOn`
    - **IF 編輯模式:**
        - **更新:** 本機 DB 該筆記錄
        - **欄位:** 必須更新 `updatedOn`
    - **成功後:**
        - **導航:** 關閉畫面，返回 CategoryListScreen


---

## 導航

- **進入:**
    - **來源:** CategoryListScreen
    - **必要參數:** categoryType 支出或收入
    - **可選參數:** categoryId 用於編輯模式
- **退出:**
    - **觸發:** 點擊關閉按鈕或儲存/刪除成功
    - **導航:** 返回上一頁