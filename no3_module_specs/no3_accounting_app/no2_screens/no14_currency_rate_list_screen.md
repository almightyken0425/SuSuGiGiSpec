# 匯率管理畫面: CurrencyRateListScreen

## 畫面目標

- **定位:** 付費功能
- **提供:** 查看並更新各貨幣對最新有效匯率的儀表板
- **溝通:** 匯率的計算與應用規則

```text
+--------------------------------+
| < Back  Currency Rates      +  |
+--------------------------------+
| Description text here...       |
|                                |
| 1 USD = 32.5 TWD               |
| Updated: Oct 25                |
|                                |
| 1 JPY = 0.21 TWD               |
| Updated: Oct 25                |
|                                |
|                                |
|                                |
+--------------------------------+
```

---

## UI 佈局

- **頂部導航列:**
    - `返回按鈕`
        - **導航:** SettingsScreen
    - `標題` 匯率管理
    - `新增按鈕`
        - **圖示:** +
        - **導航:** CurrencyRateEditorScreen
        - **模式:** 新增
- **說明文字區:**
    - **內容:** 此處顯示各貨幣對的最新有效匯率。當您進行跨幣別轉帳時，系統會自動記錄當下的匯率。所有報表在計算總資產時，將統一採用您在此處設定的最新匯率進行換算。您可以點擊下方的匯率項目來手動更新。
- **匯率列表:**
    - **UI:** FlatList
    - **邏輯:** 僅顯示使用者所有貨幣對的最新一筆有效匯率
    - **空狀態:** 當您新增外幣帳戶或進行跨幣別轉帳時，相關匯率將會顯示於此。
    - **列表項目:**
        - `匯率顯示` 1 USD = 32.5 TWD
        - `更新日期` 顯示匯率的最後更新日期 `rateDate` 格式 Date Without Year

---

## 核心邏輯

- **資料載入:**
    - **觸發:** 畫面載入
    - **查詢:** `CurrencyRates` 表
    - **邏輯:**
        - 依 `currencyFromId`, `currencyToId` 分組
        - 於每組中找出 `rateDate` 最新的一筆記錄
    - **顯示:** 將找出的最新有效匯率顯示在列表
- **互動:**
    - **點擊項目:**
        - **行為:** 視為更新匯率
        - **導航:** CurrencyRateEditorScreen
        - **參數:** 傳入該貨幣對資訊
        - **模式:** 新增
- **付費牆檢查:**
    - **觸發:** 從 SettingsScreen 導航進入前
    - **檢查:** `PremiumLogic.checkPremiumStatus()`
    - **IF 免費版:**
        - **導航:** PaywallScreen

---

## 導航

- **進入:**
    - **來源:** SettingsScreen
    - **權限:** 需為付費用戶
- **退出:**
    - **觸發:** 頂部導航列返回按鈕
    - **導航:** SettingsScreen
- **導出:**
    - **觸發:** 點擊列表項目或新增按鈕
    - **導航:** CurrencyRateEditorScreen