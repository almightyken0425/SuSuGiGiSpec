# 規格撰寫規範

## 核心原則

- **易維護性優先:** 文件的結構應優先考慮未來的修改成本。避免使用任何會導致連鎖修改的寫法,例如數字編號。
- **元件導向:** 以元件或功能區塊為最小單位來組織文件。
- **原子化:** 盡可能讓一個條目,一行,只傳達一個規格屬性。
- **隱含順序:** 條列的**視覺順序**即代表其在 UI 上的**佈局順序**,由上至下, 由左至右。

---

## 規格文件命名規範

- **原則:** 確保所有規格文件易於排序、查找且目的明確。
- **格式:** `no[編號]_[主題].md`
- **`[編號]`:**
    - **用途:** 定義文件的邏輯順序與分類
    - **規則:**
        - `0_X`: 核心原則
        - `1_X`: 資料結構
        - `2_X`: 核心功能
        - `5_X`: 畫面規格
        - `6_X`: 模組規格
- **`[主題]`:**
    - **用途:** 簡短描述文件內容
    - **規則:**
        - 全小寫英文
        - 使用 `_` snake_case 分隔單字
        - 結尾可選 `_spec`
- **範例:**
    - `no0_1_spec_writing_policy.md`
    - `no1_data_structure.md`
    - `no5_2_home_screen_spec.md`

---

## 規格資料夾命名規範

- **原則:**
    - 當未來規格文件過多時,可依此規範建立資料夾進行分類
    - 資料夾命名應對應 `[編號]` 的主要分類
- **格式:** `no[編號]_[分類主題]`
- **`[編號]`:**
    - **用途:** 對應文件編號的主要分類
    - **範例:** `no0`, `no1`, `no5`
- **`[分類主題]`:**
    - **用途:** 描述該分類的英文
    - **規則:**
        - 全小寫英文
        - 使用 `_` (snake_case) 分隔單字
- **範例:**
    - `no0_core_principles/`
        - **存放:** `no1...` `no3...` 等
    - `no1_data_structure/`
        - **存放:** `no1_data_structure.md`
    - `no2_core_features/`
        - **存放:** `no2_core_feature.md`
    - `no5_screen_specs/`
        - **存放:** `no5_...screen_spec.md`

---

## 水平分隔線規範

- **原則:** 透過分隔線明確區隔主要上下文，減少閱讀疲勞。
- **強制:**
    - **章節前:** 除了文件第一個 `##` 標題外，所有的 `##` 二級標題上方**必須**包含一行 `---`。

- **禁止:**
    - **層級過深:** 嚴禁在 `###` 或更小的標題間使用分隔線，避免版面破碎。

---

## 沒有例外絕對禁止項目，視為癌症，必須根除

- **絕對禁止編號:**
    - **嚴禁**使用有序列表或編號,例如 `1.` `2.` `A.` `B.`。
    - **所有列表**均使用 無序列表。
- **絕對禁止星號列表:**
    - **嚴禁**使用 `*` 作為列表符號。
    - **所有列表**均使用 `-` (Hyphen) 作為列表符號。
- **絕對禁止位置描述:**
    - **嚴禁**使用 `左:` `中:` `右:` 或 `頂部:` `底部:` 來描述元件在佈局中的**相對位置**。
    - **元件的佈局**應由其在列表中的「條列順序」決定。
- **絕對禁止金錢符號:**
    - **嚴禁**使用金錢符號於範例或 UI 描述中。
- **絕對禁止最終狀態詞:**
    - **嚴禁**在標題或檔案名稱中使用 `Final` 或 `最終版` 等代表最終的狀態詞。
    - **允許:** 使用 `V1`, `V2` 等數字版本號是允許的。
- **絕對禁止括號:**
    - **嚴禁**使用任何括號或引號,例如 `()` `[]` `「」`,應改直接整合進規格描述中。
    - **嚴禁**在章節標題中使用括號進行補充說明。
- **絕對禁止備註關鍵字:**
    - **嚴禁**使用 `**備註:**` 關鍵字進行補充說明。
    - **所有**補充說明都必須整合進主要的規格描述文字中。
- **絕對禁止檔案引用:**
    - **嚴禁**在內文中直接引用其他檔案名稱,例如 `依據 no2_product_definition.md`。
    - **原因:** 檔案名稱或編號變更時,會造成大量無效連結與維護成本。
    - **替代:** 直接描述該主題,例如 `依據產品定義` 或 `參見角色定義`,讓讀者透過上下文理解,而非依賴硬編碼的檔名。
- **絕對禁止文件結束標記:**
    - **嚴禁**在文件結尾使用 `**文件結束**` 標記，文件自然結束即可。

---

## 關鍵字

- **一律粗體:** 所有的關鍵字,例如 `結構:**` `行為:**` `IF:**` 等,**必須**使用粗體並包含冒號。
- **`結構:**`**
    - **用途:** 描述一個區塊的靜態佈局或其子元件列表。
- **`行為:**`**
    - **用途:** 描述一個區塊的動態邏輯、資料處理或互動。
- **`內部元件:**`**
    - **用途:** `結構:**` 的同義詞，但應避免使用，直接列出元件即可。
- **`IF / ELSE:**`**
    - **用途:** 用於描述條件邏輯。
- **`屬性:**`**
    - **用途:** 標記元件的必填、可選狀態或其他屬性。

---

## 畫面規格撰寫規範

### 標準章節結構

- **推薦順序:**
    - `## 畫面目標` 簡述畫面的核心功能與價值
    - `## UI 佈局` 描述畫面的視覺結構與元件組成
    - `## 核心邏輯` 說明資料處理、互動行為、業務邏輯
    - `## 導航` 定義進入與退出的導航行為
- **可選章節:**
    - `## 權限邏輯` 若有特定權限檢查邏輯
    - `## 錯誤處理` 若有特殊錯誤處理邏輯

### 元件命名規範

- **UI 元件使用反引號:**
    - **規則:** 所有 UI 元件名稱必須使用反引號包裹
    - **範例:** `取消按鈕` `日曆選擇器` `金額輸入框`
    - **目的:** 明確區分元件名稱與一般描述文字
- **元件名稱格式:**
    - **推薦:** 使用 元件類型 + 功能描述 格式
    - **範例:** `取消按鈕` `轉出帳戶選擇器` `時間選擇器`
    - **禁止:** 使用技術術語作為唯一描述

### 避免冗餘層級

- **禁止:** 不必要的「內部元件」層級

- **禁止**
    
    ```
    - **頂部 Header:**
        - **內部元件:**
            - `取消按鈕`
            - `標題`
            - `儲存按鈕`
    
    ```
    
- **推薦:** 直接列出元件，避免中間層級
    
    ```
    - **頂部 Header:**
        - `取消按鈕`
        - `標題`
        - `儲存按鈕`
    
    ```

### 結構模板引用

- **使用時機:** 當多個區塊共用相同的 UI 結構時
- **推薦作法:**
    - 定義一次結構模板
    - 其他地方引用該模板
    - 避免重複描述相同結構
- **範例:**
    
    ```
    - **逐筆紀錄區塊:**
        - **支出區 Section:** 採用交易群組結構
        - **收入區 Section:** 採用交易群組結構
        - **交易群組結構:**
            - **分組標題列:**
                - `收合圖示`
                - `分組標題`
                - `分組金額`
            - **單筆紀錄列:**
                - `金額`
                - `備註`
    
    ```

### 條件邏輯描述

- **IF 條件格式:**
    - **規則:** 使用粗體格式標記條件
    - **範例:** `**IF 單幣別:**` `**IF 編輯模式:**`
- **條件內容:**
    - **推薦:** 條件後直接描述行為或顯示內容
    - **禁止:** 條件後留空或僅有子條件
- **範例:**
    
    ```
    - **轉入金額輸入框:**
        - **IF 同幣別轉帳:**
            - **可見性:** 不顯示
            - **儲存邏輯:** amountToCents = amountFromCents
        - **IF 跨幣別轉帳:**
            - **可見性:** 顯示並可編輯
    
    ```

### 屬性標記

- **必填與可選:**
    - **規則:** 使用粗體標記元件的必填或可選狀態
    - **預設:** 未標記必填的元件均為可選
    - **範例:** `**屬性:** 必填` 或 `**屬性:** 可選`
- **其他屬性:**
    - **樣式** 描述視覺樣式
    - **鍵盤** 描述鍵盤類型
    - **可見性** 描述顯示條件
    - **權限** 描述權限要求
- **範例:**
    
    ```
    - **項目 UI 內容:**
        - 帳戶
        - 備註
    
    ```

### 邏輯段落組織

- **資料處理:** 描述資料來源、過濾、聚合、排序邏輯
- **互動行為:** 描述使用者操作與系統回應
- **模式判斷:** 描述新增與編輯模式的判斷與預設值
- **儲存與刪除:** 描述資料持久化邏輯與導航行為

### 導航段落

- **進入:**
    - **來源** 列出可能的來源畫面
    - **必要參數** 列出必須傳遞的參數
    - **可選參數** 列出可選的參數
- **退出:**
    - **觸發** 描述退出的觸發條件
    - **行為** 描述退出的導航行為
    - **回傳** 若有回傳值，描述回傳內容

---

## 撰寫範例補充

### 邏輯分組

- **禁止**
    - **佈局:** 重複且扁平
    
    ```
    - **顯示模式:**
      - **選項: 按類別分組**
        - **聚合:** 依 `categoryId`
        - **互動:** 可展開
      - **選項: 按日期分組**
        - **聚合:** 依 `transactionDate`
        - **互動:** 可展開
    
    ```
    
- **推薦**
    - **佈局:** 合併共用屬性,建立子集
    
    ```
    - **顯示模式:**
      - **屬性:** 可切換
      - **預設:** 類別分組
      - **分組:**
        - **按類別**
          - **聚合:** 依 `categoryId`
        - **按日期**
          - **聚合:** 依 `transactionDate`
      - **互動:** 可展開
    
    ```

### 關鍵字分組

- **禁止**
    - **關鍵:** 重複的關鍵字
    
    ```
    - **選項 - 此筆及未來所有 - 編輯:**
      - **行為:** 將原 Schedule 的 EndOn 設為此交易日期的前一週期
      - **行為:** 根據新內容創建一個新 Schedule
      - **行為:** 不修改任何歷史記錄
    
    ```
    
- **推薦**
    - **關鍵:** 使用縮排群組
    
    ```
    - **選項 - 此筆及未來所有 - 編輯:**
      - **行為:**
        - 將原 Schedule 的 EndOn 設為此交易日期的前一週期
        - 根據新內容創建一個新 Schedule
        - 不修改任何歷史記錄
    
    ```

### 關鍵字省略

- **禁止**
    - **關鍵:** 關鍵字多餘
    
    ```
    ## 搜尋交易
    - **行為:** 僅搜尋 Note 欄位。
    
    ```
    
- **推薦**
    - **關鍵:** 標題已定義行為
    
    ```
    ## 搜尋交易
    - 僅搜尋 Note 欄位。
    
    ```
