# 匯率編輯器畫面: CurrencyRateEditorScreen

## 畫面目標

- **提供:** 新增或更新特定貨幣對匯率的介面
- **確保:** 使用者輸入的資料有效且完整

```text
+--------------------------------+
| Cancel     Set Rate     Done   |
+--------------------------------+
|                                |
| Date: Oct 25, 24               |
|                                |
| [ From Cur ]      [ To Cur ]   |
|                                |
| [ Amount A ]  =  [ Amount B ]  |
|                                |
|                                |
+--------------------------------+
```

---

## UI 佈局

- **頂部導航列:**
    - `取消按鈕`
        - **導航:** CurrencyRateListScreen
    - `標題` 設定匯率
    - `完成按鈕`
- **日期選擇器:**
    - `日期選擇器`
        - **UI:** 日期選擇元件
        - **預設值:** 今天
- **貨幣對顯示區:**
    - **UI:** 兩個並排的不可編輯區塊
    - `來源貨幣` From
    - `目標貨幣` To
    - **邏輯:**
        - **IF 從列表進入:**
            - **顯示:** 被點擊的貨幣對
        - **IF 從新增按鈕進入:**
            - **允許:** 使用者選擇貨幣對
- **匯率輸入區:**
    - `來源金額輸入框 Amount From`
        - **UI:** 數字輸入框
        - **預設值:** 1
    - `等號標籤` =
    - `目標金額輸入框 Amount To`
        - **UI:** 數字輸入框


---

## 核心邏輯

- **模式判斷:**
    - **觸發:** 畫面載入
    - **判斷依據:** 傳入的參數
    - **IF 傳入 rateId 或貨幣對資訊 更新模式:**
        - **載入:** 該貨幣對並填充欄位
        - **備註:** 儲存時仍為新增操作
- **儲存邏輯:**
    - **觸發:** 點擊儲存按鈕
    - **驗證:**
        - `Amount From` 與 `Amount To` 皆為有效數字且大於 0
    - **儲存:**
        - **計算:** `rate = Amount To / Amount From`
        - **寫入:** 本機 DB 的 `CurrencyRates` 表新增一筆記錄
        - **策略:** 一律為新增 Append-Only
        - **欄位:** 必須設定 `updatedOn`
    - **成功後:**
        - **導航:** 返回 CurrencyRateListScreen
        - **觸發:** CurrencyRateListScreen 資料重新整理
- **刪除策略:**
    - **行為:** 不提供刪除按鈕

---

## 導航

- **進入:**
    - **來源:** CurrencyRateListScreen 新增按鈕或列表項目
    - **可選參數:** rateId 或貨幣對資訊
- **退出:**
    - **觸發:** 點擊取消按鈕或儲存按鈕
    - **導航:** CurrencyRateListScreen