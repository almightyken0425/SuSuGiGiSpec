# 架構決策與權衡

## 雲端資料庫：Firestore

- **決策:** 付費版功能使用 Google Firestore 作為跨裝置同步與備份的後端
- **決策理由 Pros:**
    - **託管服:** 無需自行維護伺服器、資料庫與 API
    - **認證整合:** 與 Firebase Auth (Google 登入) 無縫整合, 易於管理使用者身份與權限
    - **即時同步:** 若未來決定放棄批次同步, 可改為即時同步模型
    - **開發速度:** 提供強大的 SDK, 加速付費版同步功能的開發
- **考量層面 Cons & Trade-offs:**
    - **成本模型:** 成本與 讀/寫 次數掛鉤, 而非固定月費, 需謹慎設計同步邏輯
    - **廠商鎖定:** 依賴特定廠商的服務, 未來遷移至自建後端的成本較高
    - **資料主權:** 使用者資料儲存在第三方平台, 需在隱私權政策中明確揭露

## 匯率：手動維護

- **決策:** 匯率不使用外部 API, 必須由使用者手動輸入或由跨幣別轉帳時自動記錄
- **決策理由:**
    - **核心原則 - 離線運作:** 依賴外部 API 會破壞 App 100% 離線運作的核心架構
    - **成本考量:** 穩定、即時的匯率 API 均需付費, 且費用無法預估
    - **反映真實匯率:** API 無法反映使用者私下換匯的匯率
    - **價值權衡:** 對記帳而言, 「現行匯率」的參考價值已足夠, 即時的精確匯率並非核心痛點
    - **簡化架構:** 避免處理 API 失敗、網路中斷、非同步載入等複雜錯誤

## 認證：僅 Google 登入

- **決策:** MVP 階段僅支援 Google 登入, 排除 Apple 登入
- **決策理由 Pros:**
    - **簡化開發:** 專注於單一認證流程, 加速 MVP 開發
    - **平台一致性:** Google 登入可同時支援 Android 與 iOS 平台
    - **後端整合:** 與 Firestore 的權限管理可無縫整合
- **考量層面 Cons & Trade-offs:**
    - **iOS 使用者摩擦:** Apple 平台使用者可能更偏好或僅有 Apple ID
    - **App Store 審核風險:**
        - 需注意 Apple 審核指南 4.8 條款
        - 若 App 提供第三方登入 (如 Google), *可能* 會被要求 *必須* 同時提供 Apple 登入
    - **未來工作:** 若未來追加支援 Apple 登入, 需處理帳號合併或遷移的複雜邏輯