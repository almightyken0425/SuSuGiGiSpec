# 搜尋畫面 (SearchScreen)

_(本文件定義「搜尋」畫面的 UI、流程與邏輯)_

## 畫面目標 (Screen Objective)

- 提供一個介面，讓使用者能快速搜尋所有交易與轉帳的備註 (`Note`) 欄位。
    
- 允許使用者從搜尋結果中，快速導航至該筆紀錄的編輯畫面。
    

## UI 佈局與元件 (UI Layout & Components)

- **頂部導航列 (Top Navigation Bar):**
    
    - **左側:** 「返回」按鈕，導航回前一頁（通常是「首頁」）。
        
    - **中間:** 搜尋輸入框 (`TextInput`)。
        
        - **UI:** 應有「搜尋備註...」的提示文字。
            
        - **互動:** 應有 `autoFocus` 屬性，使用者進入此畫面時應自動彈出鍵盤。
            
- **搜尋結果區 (Results Area):**
    
    - **UI:** 一個可滾動的列表 (`FlatList`)。
        
    - **空狀態 (Empty State):**
        
        - **預設 (尚未輸入):** 顯示提示文字，例如「請輸入關鍵字以搜尋交易備註。」
            
        - **無結果 (No Results):** 顯示提示文字，例如「找不到符合『[關鍵字]』的紀錄。」
            
    - **結果列表 (Results List):**
        
        - **UI:** 顯示所有符合關鍵字的交易與轉帳紀錄。
            
        - **排序:** 應按「交易日期 (`TransactionDate`)」降冪排列（最新的在最上面）。
            
        - **項目內容 (每筆):**
            
            - 左側：類別圖示 (`Icon`)。
                
            - 中間 (垂直排列):
                
                - 上方：類別名稱 (`Name`) 或「轉帳」。
                    
                - 下方：備註 (`Note`)，應將「關鍵字」以**粗體**或高亮顯示。
                    
            - 右側 (垂直排列):
                
                - 上方：金額 (原始幣別)。
                    
                - 下方：日期。
                    

## 核心邏輯

- **資料搜尋邏輯:**
    
    - **觸發:** 當使用者在搜尋框中輸入文字（建議有 debounce 處理，例如停止輸入 300ms 後）時觸發。
        
    - **來源:** 查詢「**本機資料庫 (Local DB)**」。
        
    - **範圍:** 搜尋 `Transactions` 和 `Transfers` 兩個資料表。
        
    - **條件:**
        
        - `note` 欄位包含（`CONTAINS` 或 `LIKE`）使用者輸入的關鍵字（不分大小寫）。
            
        - **必須**限定 `deletedOn` 為 `null`。
            
    - **效能:** 此查詢（特別是 `LIKE`）可能較慢，應在本機資料庫的 `note` 欄位上建立索引 (index)。
        
- **導航邏輯 (Navigation Logic):**
    
    - **互動:** 使用者點擊列表中的任一筆搜尋結果。
        
    - **動作:**
        
        - **若為 `Transaction` 紀錄:** 導航至「交易編輯器畫面」，並傳入 `transactionId`。
            
        - **若為 `Transfer` 紀錄:** 導航至「轉帳編輯器畫面」，並傳入 `transferId`。
            

## 狀態管理 (State Management)

- 使用 `useState` 管理以下狀態：
    
    - `searchText: string` (搜尋框的當前文字)
        
    - `results: (Transaction | Transfer)[]` (從本機資料庫查詢到的結果)
        
    - `isLoading: boolean` (是否正在查詢中)