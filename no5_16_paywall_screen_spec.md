# 付費牆畫面 (PaywallScreen)

_(本文件定義「升級至 Premium」畫面的 UI、流程與邏輯)_

## 畫面目標 (Screen Objective)

- 作為 App 的核心營收畫面，清楚傳達 Premium 版本的**雙重價值**（功能解鎖 + 雲端同步）。
    
- 提供一個無摩擦的介面，引導使用者完成訂閱流程。
    
- 處理購買與恢復購買的邏輯。
    

## 觸發情境 (Trigger Points)

此畫面應在以下任一情境中，以 Modal 形式彈出：

- **主動觸發 (Direct Trigger):**
    
    - 使用者點擊「設定主頁」上的「升級至 Premium」按鈕。
        
- **被動觸發 (Feature-Lock Trigger):**
    
    - 當使用者在 App 中嘗試存取任何「付費功能」時，由各功能畫面自行檢查 `isPremiumUser` 狀態並呼叫此畫面。
        
    - _（例如：在「帳戶列表」中嘗試建立第 4 個帳戶，或在「偏好設定」中點擊「立即同步」時）。_
        

## UI 佈局與元件 (UI Layout & Components)

- **頂部導航列 (Top Navigation Bar):**
    

## UI 佈局與元件 (UI Layout & Components)

- **頂部導航列 (Top Navigation Bar):**
    
    - **右側 (或左側):** 「關閉」按鈕 (一個 `X` 圖示)，允許使用者關閉付費牆。
        
- **主要價值主張 (Main Value Prop):**
    
    - **標題:** 一個強而有力的標題，例如「**解鎖速速記記的完整潛力**」。
        
    - **副標題:** 說明核心價值，例如「解鎖無限功能，並啟用安全的雲端備份。」
        
- **功能列表 (Features List):**
    
    - **UI:** 一個清晰的、以圖示 + 文字呈現的功能列表，展示 Premium 的**所有**優勢：
        
    - **[i18n]** (所有功能描述)
        
    - **雲端與備份 (Cloud & Backup)**
        
        - `[圖示]` **每日雲端備份:** 資料自動備份，手機遺失也不怕。
            
        - `[圖示]` **跨裝置同步:** 在您的所有裝置上同步資料。
            
    - **核心功能 (Core Features)**
        
        - `[圖示]` **無限帳戶:** 建立不限數量的帳戶 (免費版限制 3 個)。
            
        - `[圖示]` **無限類別:** 建立不限數量的類別 (免費版限制 10 個)。
            
    - **進階理財 (Advanced Finance)**
        
        - `[圖示]` **多幣別支援:** 管理您的外幣資產與匯率。
            
        - `[圖示]` **定期交易:** 自動建立您的週期性收支。
            
    - **資料工具 (Data Tools)**
        
        - `[圖示]` **資料匯入:** 從 CSV 檔案快速遷移您的歷史紀錄。
            
- **訂閱選項區 (Subscription Options):**
    
    - **UI:** 兩個並排或堆疊的可選框（應**突顯**年度方案）。
        
    - **選項 1 (推薦): 年度方案**
        
        - **價格:** 動態顯示 `[RevenueCat 取回的年度價格]` (例如 "NT$ 360 / 年")。
            
        - **折扣標示:** 動態計算並顯示月均價 (例如 "(平均 NT$ 30 / 月)")。
            
    - **選項 2: 月度方案**
        
        - **價格:** 動態顯示 `[RevenueCat 取回的月度價格]` (例如 "NT$ 40 / 月")。
            
- **行動呼籲按鈕 (Call to Action - CTA):**
    
    - **UI:** 一個大型、醒目的主要按鈕。
        
    - **文字:** 「**升級並開始 7 天免費試用**」或「**立即升級**」。
        
- **頁腳連結 (Footer Links):**
    
    - **UI:** 三個小型的純文字連結，位於畫面最底部。
        
    - **恢復購買 (Restore Purchase):** 點擊後觸發恢復購買邏輯。
        
    - **服務條款 (Terms of Service):** 連結至服務條款網頁。
        
    - **隱私權政策 (Privacy Policy):** 連結至隱私權政策網頁。
        

## 核心邏輯

- **串接服務 (Service Integration):**
    
    - App 必須串接一個跨平台購買服務（如 **RevenueCat**），以簡化 App Store 與 Google Play 的訂閱管理。
        
- **動態價格載入 (Dynamic Price Loading):**
    
    - 畫面載入時，**必須**呼叫 `RevenueCat.getOfferings()`。
        
    - **嚴禁**在 App 內寫死價格。
        
    - 從 RevenueCat 取回「本地化」的價格字串（例如 "NT$ 360" 或 "$11.99"），並顯示在訂閱選項 UI 上。
        
- **購買邏輯 (Purchase Logic):**
    
    - 使用者選擇一個方案（例如「年度方案」）並點擊 CTA 按鈕。
        
    - App 呼叫 `RevenueCat.purchasePackage()` 並傳入所選的方案。
        
    - **購買成功:**
        
        - RevenueCat SDK (或後端 Webhook) 確認購買有效。
            
        - App **必須**更新「**本機狀態 (e.g., PremiumContext)**」中的 `isPremiumUser` 為 `true`。
            
        - 顯示一個「升級成功！」的提示。
            
        - 自動關閉此 `PaywallScreen` 畫面。
            
    - **購買失敗/取消:**
        
        - 顯示「購買失敗」或「已取消」的提示。
            
- **恢復購買邏輯 (Restore Logic):**
    
    - 使用者點擊「恢復購買」。
        
    - App 呼叫 `RevenueCat.restorePurchases()`。
        
    - **恢復成功:**
        
        - App 更新「**本機狀態**」中的 `isPremiumUser` 為 `true`。
            
        - 顯示「恢復成功！」提示，並自動關閉此畫面。
            
    - **恢復失敗 (無紀錄):**
        
        - 顯示「找不到您的購買紀錄」提示。
            

## 導航 (Navigation)

- **進入:** 以 Modal 形式從多個「觸發情境」開啟。
    
- **退出:**
    
    - 點擊「關閉」按鈕。
        
    - 購買或恢復成功後，自動關閉。